{"ast":null,"code":"var _jsxFileName = \"/home/alrin/reactproject/kms-ui/src/components/role-management/components/CreateRole.js\";\nimport React, { Component } from 'react';\nimport { Row, Col, Container } from 'reactstrap';\nimport { Redirect } from 'react-router-dom';\nimport _ from 'lodash';\nimport Permissions from './Permissions';\nimport { CustomButton, BUTTON_STYLE, BUTTON_TYPE, BUTTON_SIZE, COLOR } from '@6d-ui/buttons';\nimport { FieldItem, validateForm } from '@6d-ui/fields';\nimport { ROLES as FormElements } from './util/FormElements';\nexport default class CreateRole extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      permissions: '',\n      modules: [],\n      isSuccess: false,\n      fields: {}\n    };\n    this.getRequest = this.getRequest.bind(this);\n    this.handleSwitch = this.handleSwitch.bind(this);\n    this.getPermissions = this.getPermissions.bind(this);\n    this.handleDropDownChange = this.handleDropDownChange.bind(this);\n    this.props.setHeader(\"Roles\");\n  }\n\n  componentDidMount() {\n    this.props.ajaxUtil.sendRequest(this.props.url_Roles.GET_FEATURES, {}, response => {\n      this.setState({\n        modules: response && response.response\n      });\n    }, this.props.loadingFunction, {\n      method: 'GET',\n      isShowSuccess: false\n    });\n  }\n\n  getDefaultPermissions(permissions) {\n    const permissionList = [];\n\n    _.forEach(permissions, function (feature) {\n      if (_.parseInt(feature.isDefault) === 1) {\n        const temp = {\n          'value': feature.featureId,\n          'label': feature.featureName\n        };\n        permissionList.push(temp);\n      }\n    });\n\n    return permissionList;\n  }\n\n  handleChange(name, value, obj) {\n    const {\n      isTouched\n    } = obj || {\n      isTouched: false\n    };\n\n    if (isTouched) {\n      value = this.state[name];\n    }\n\n    const fields = this.state.fields;\n    const validate = validateForm(name, value, FormElements[name], null, null);\n\n    if (validate) {\n      fields[name] = validate;\n    } else {\n      fields[name] = {\n        hasError: false,\n        errorMsg: ''\n      };\n    }\n\n    this.setState({\n      [name]: value,\n      fields\n    });\n  }\n\n  createCheck(response, hasError) {\n    if (!hasError) {\n      this.setState({\n        isSuccess: true\n      });\n    }\n  }\n\n  onSubmitClick() {\n    const preValidate = (name, value, field) => {\n      if (name === 'roleId') return {\n        hasError: false,\n        errorMsg: ''\n      };\n    };\n\n    let hasError = false;\n    const fields = this.state.fields;\n    const that = this;\n\n    _.forEach(FormElements, function (value, name) {\n      const validate = validateForm(name, that.state[name], FormElements[name], preValidate, null);\n\n      if (validate) {\n        if (hasError === false) hasError = validate.hasError;\n        fields[name] = validate;\n      } else {\n        fields[name] = {\n          hasError: false,\n          errorMsg: ''\n        };\n      }\n    });\n\n    this.setState({\n      fields\n    });\n\n    if (hasError === true) {\n      this.props.setNotification({\n        message: this.props.messagesUtil.EMPTY_FIELD_MSG,\n        hasError: true,\n        timestamp: new Date().getTime()\n      });\n      return false;\n    }\n\n    const request = this.getRequest();\n    this.props.ajaxUtil.sendRequest(this.props.url_Roles.CREATE_URL, request, this.createCheck.bind(this), this.props.loadingFunction, {\n      isProceedOnError: false\n    });\n  }\n\n  getRequest() {\n    const featureList = [];\n    const reqPermissions = this.state.permissions;\n    Object.keys(reqPermissions).forEach(function (key) {\n      if (!_.isEmpty(reqPermissions[key])) reqPermissions[key].forEach((feature, index) => {\n        featureList.push({\n          featureId: feature.value\n        });\n      });\n    });\n    return {\n      \"roleName\": this.state.roleName,\n      \"featureList\": featureList // \"roleName\": this.state.roleName,\n      // \"createdUser\": \"1\",\n      // \"featureIds\": featureList\n\n    };\n  }\n\n  handleDropDownChange(name, selectedOption, obj) {\n    const {\n      isTouched\n    } = obj || {\n      isTouched: false\n    };\n\n    if (!isTouched && selectedOption) {\n      if (selectedOption.length > 0) this.setState({\n        permissions: { ...this.state.permissions,\n          [name]: selectedOption\n        }\n      });else this.setState({\n        permissions: { ...this.state.permissions,\n          [name]: ''\n        }\n      });\n    }\n  }\n\n  handleSwitch(data, e) {\n    const resetState = this.getDefaultPermissions(data.features);\n\n    if (e.target.checked) {\n      this.setState({\n        permissions: { ...this.state.permissions,\n          [data.moduleId]: resetState\n        }\n      });\n    } else {\n      this.setState({\n        permissions: { ...this.state.permissions,\n          [data.moduleId]: ''\n        }\n      });\n    }\n  }\n\n  onCancel() {\n    this.setState({\n      isSuccess: true\n    });\n  }\n\n  getPermissions(permissions) {\n    const permissionList = [];\n\n    _.forEach(permissions, function (feature) {\n      const temp = {\n        'value': feature.featureId,\n        'label': feature.featureName\n      };\n      permissionList.push(temp);\n    });\n\n    return permissionList;\n  }\n\n  render() {\n    if (this.state.isSuccess) {\n      return /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/Roles\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 14\n        }\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"custom-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-Brick\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-Brick-Head\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 13\n      }\n    }, \"Role Details\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-Brick-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      className: \"mx-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(FieldItem, Object.assign({}, FormElements.roleName, {\n      value: this.state.roleName,\n      onChange: this.handleChange.bind(this, FormElements.roleName.name),\n      touched: this.state.fields.roleName && this.state.fields.roleName.hasError,\n      error: this.state.fields.roleName && this.state.fields.roleName.errorMsg,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 15\n      }\n    }))))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-Brick\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-Brick-Head\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 13\n      }\n    }, \"Permissions\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-Brick-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      className: \"mx-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Container, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      className: \"form-card-header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      md: \"3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 19\n      }\n    }, \"Modules\"), /*#__PURE__*/React.createElement(Col, {\n      md: \"3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 19\n      }\n    }), /*#__PURE__*/React.createElement(Col, {\n      md: \"6\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 19\n      }\n    }, \"Permissions\"))), /*#__PURE__*/React.createElement(Permissions, {\n      modules: this.state.modules,\n      handleDropDownChange: this.handleDropDownChange,\n      getPermissions: this.getPermissions,\n      handleSwitch: this.handleSwitch,\n      permissions: this.state.permissions,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 15\n      }\n    })))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container-fluid\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(CustomButton, {\n      style: BUTTON_STYLE.BRICK,\n      type: BUTTON_TYPE.PRIMARY,\n      size: BUTTON_SIZE.LARGE,\n      align: \"right\",\n      label: \"Create\",\n      isButtonGroup: true,\n      onClick: this.onSubmitClick.bind(this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(CustomButton, {\n      style: BUTTON_STYLE.BRICK,\n      type: BUTTON_TYPE.SECONDARY,\n      size: BUTTON_SIZE.LARGE,\n      color: COLOR.PRIMARY,\n      align: \"right\",\n      label: \"Cancel\",\n      isButtonGroup: true,\n      onClick: this.onCancel.bind(this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        height: \"100px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}","map":{"version":3,"sources":["/home/alrin/reactproject/kms-ui/src/components/role-management/components/CreateRole.js"],"names":["React","Component","Row","Col","Container","Redirect","_","Permissions","CustomButton","BUTTON_STYLE","BUTTON_TYPE","BUTTON_SIZE","COLOR","FieldItem","validateForm","ROLES","FormElements","CreateRole","constructor","props","state","permissions","modules","isSuccess","fields","getRequest","bind","handleSwitch","getPermissions","handleDropDownChange","setHeader","componentDidMount","ajaxUtil","sendRequest","url_Roles","GET_FEATURES","response","setState","loadingFunction","method","isShowSuccess","getDefaultPermissions","permissionList","forEach","feature","parseInt","isDefault","temp","featureId","featureName","push","handleChange","name","value","obj","isTouched","validate","hasError","errorMsg","createCheck","onSubmitClick","preValidate","field","that","setNotification","message","messagesUtil","EMPTY_FIELD_MSG","timestamp","Date","getTime","request","CREATE_URL","isProceedOnError","featureList","reqPermissions","Object","keys","key","isEmpty","index","roleName","selectedOption","length","data","e","resetState","features","target","checked","moduleId","onCancel","render","BRICK","PRIMARY","LARGE","SECONDARY","height"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Row, Col, Container } from 'reactstrap';\r\nimport { Redirect } from 'react-router-dom';\r\nimport _ from 'lodash';\r\nimport Permissions from './Permissions';\r\nimport {\r\n  CustomButton,\r\n  BUTTON_STYLE,\r\n  BUTTON_TYPE,\r\n  BUTTON_SIZE,\r\n  COLOR\r\n} from '@6d-ui/buttons';\r\nimport { FieldItem, validateForm } from '@6d-ui/fields';\r\nimport { ROLES as FormElements } from './util/FormElements';\r\n\r\n\r\nexport default class CreateRole extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      permissions: '',\r\n      modules: [],\r\n      isSuccess: false,\r\n      fields: {}\r\n    };\r\n    this.getRequest = this.getRequest.bind(this);\r\n    this.handleSwitch = this.handleSwitch.bind(this);\r\n    this.getPermissions = this.getPermissions.bind(this);\r\n    this.handleDropDownChange = this.handleDropDownChange.bind(this);\r\n    this.props.setHeader(\"Roles\");\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.ajaxUtil.sendRequest(this.props.url_Roles.GET_FEATURES,\r\n\r\n      {}, (response) => {\r\n        this.setState({\r\n          modules: response&&response.response\r\n\r\n        });\r\n      }, this.props.loadingFunction, { method: 'GET', isShowSuccess: false });\r\n  }\r\n\r\n  getDefaultPermissions(permissions) {\r\n    const permissionList = [];\r\n    _.forEach(permissions, function (feature) {\r\n      if (_.parseInt(feature.isDefault) === 1) {\r\n        const temp = {\r\n          'value': feature.featureId,\r\n          'label': feature.featureName\r\n        }\r\n        permissionList.push(temp);\r\n      }\r\n    });\r\n    return permissionList;\r\n  }\r\n\r\n  handleChange(name, value, obj) {\r\n    const { isTouched } = obj || { isTouched: false };\r\n    if (isTouched) {\r\n      value = this.state[name];\r\n    }\r\n    const fields = this.state.fields;\r\n    const validate = validateForm(name, value, FormElements[name], null, null);\r\n    if (validate) {\r\n      fields[name] = validate;\r\n    } else {\r\n      fields[name] = { hasError: false, errorMsg: '' };\r\n    }\r\n    this.setState({ [name]: value, fields });\r\n\r\n  }\r\n\r\n  createCheck(response, hasError) {\r\n    if (!hasError) {\r\n      this.setState({ isSuccess: true });\r\n    }\r\n  }\r\n\r\n  onSubmitClick() {\r\n    const preValidate = (name, value, field) => {\r\n      if (name === 'roleId')\r\n        return { hasError: false, errorMsg: '' };\r\n    }\r\n    let hasError = false;\r\n    const fields = this.state.fields;\r\n    const that = this;\r\n    _.forEach(FormElements, function (value, name) {\r\n      const validate = validateForm(name, that.state[name], FormElements[name], preValidate, null);\r\n      if (validate) {\r\n        if (hasError === false) hasError = validate.hasError;\r\n        fields[name] = validate;\r\n      } else {\r\n        fields[name] = { hasError: false, errorMsg: '' };\r\n      }\r\n    });\r\n    this.setState({ fields });\r\n    if (hasError === true) {\r\n      this.props.setNotification({\r\n        message: this.props.messagesUtil.EMPTY_FIELD_MSG,\r\n        hasError: true,\r\n        timestamp: new Date().getTime()\r\n      });\r\n      return false;\r\n    }\r\n    const request = this.getRequest();\r\n    this.props.ajaxUtil.sendRequest(this.props.url_Roles.CREATE_URL, request, this.createCheck.bind(this), this.props.loadingFunction, { isProceedOnError: false });\r\n\r\n  }\r\n\r\n  getRequest() {\r\n    const featureList = []\r\n    const reqPermissions = this.state.permissions;\r\n\r\n    Object.keys(reqPermissions).forEach(function (key) {\r\n      if (!_.isEmpty(reqPermissions[key]))\r\n        reqPermissions[key].forEach((feature, index) => {\r\n          featureList.push({ featureId: feature.value });\r\n        });\r\n    }\r\n    );\r\n\r\n\r\n\r\n    return {\r\n      \"roleName\": this.state.roleName,\r\n      \"featureList\": featureList\r\n      // \"roleName\": this.state.roleName,\r\n      // \"createdUser\": \"1\",\r\n      // \"featureIds\": featureList\r\n    }\r\n  }\r\n\r\n  handleDropDownChange(name, selectedOption, obj) {\r\n\r\n    const { isTouched } = obj || { isTouched: false };\r\n    if (!isTouched && selectedOption) {\r\n      if (selectedOption.length > 0)\r\n        this.setState({\r\n          permissions: {\r\n            ...this.state.permissions,\r\n            [name]: selectedOption\r\n          }\r\n        });\r\n      else\r\n        this.setState({\r\n          permissions: {\r\n            ...this.state.permissions,\r\n            [name]: ''\r\n          }\r\n        });\r\n    }\r\n  }\r\n\r\n  handleSwitch(data, e) {\r\n    const resetState = this.getDefaultPermissions(data.features);\r\n    if (e.target.checked) {\r\n      this.setState({\r\n        permissions: {\r\n          ...this.state.permissions,\r\n          [data.moduleId]: resetState\r\n        }\r\n      });\r\n    } else {\r\n      this.setState({\r\n        permissions: {\r\n          ...this.state.permissions,\r\n          [data.moduleId]: ''\r\n        }\r\n      });\r\n    }\r\n  }\r\n  onCancel() {\r\n    this.setState({ isSuccess: true });\r\n  }\r\n  getPermissions(permissions) {\r\n\r\n    const permissionList = [];\r\n    _.forEach(permissions, function (feature) {\r\n      const temp = {\r\n        'value': feature.featureId,\r\n        'label': feature.featureName\r\n      }\r\n      permissionList.push(temp);\r\n    });\r\n    return permissionList;\r\n  }\r\n\r\n  render() {\r\n    if (this.state.isSuccess) {\r\n      return <Redirect to=\"/Roles\" />;\r\n    }\r\n\r\n    return (\r\n      <div className=\"custom-container\">\r\n        <div className=\"form-Brick\">\r\n          <div className=\"form-Brick-Head\">\r\n            <span>Role Details</span>\r\n          </div>\r\n          <div className=\"form-Brick-body\">\r\n            <Row className=\"mx-0\">\r\n              <FieldItem\r\n                {...FormElements.roleName}\r\n                value={this.state.roleName}\r\n                onChange={this.handleChange.bind(this, FormElements.roleName.name)}\r\n                touched={this.state.fields.roleName && this.state.fields.roleName.hasError}\r\n                error={this.state.fields.roleName && this.state.fields.roleName.errorMsg} />\r\n            </Row>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"form-Brick\">\r\n          <div className=\"form-Brick-Head\">\r\n            <span>Permissions</span>\r\n          </div>\r\n          <div className=\"form-Brick-body\">\r\n            <Row className=\"mx-0\">\r\n              <Container>\r\n                <Row className=\"form-card-header\">\r\n                  <Col md=\"3\">Modules</Col>\r\n                  <Col md=\"3\"></Col>\r\n                  <Col md=\"6\">Permissions</Col>\r\n                </Row>\r\n              </Container>\r\n              <Permissions\r\n                modules={this.state.modules}\r\n                handleDropDownChange={this.handleDropDownChange}\r\n                getPermissions={this.getPermissions}\r\n                handleSwitch={this.handleSwitch}\r\n                permissions={this.state.permissions} />\r\n            </Row>\r\n          </div>\r\n        </div>\r\n        <div className=\"container-fluid\">\r\n          <CustomButton\r\n            style={BUTTON_STYLE.BRICK}\r\n            type={BUTTON_TYPE.PRIMARY}\r\n            size={BUTTON_SIZE.LARGE}\r\n            align=\"right\"\r\n            label=\"Create\"\r\n            isButtonGroup={true}\r\n            onClick={this.onSubmitClick.bind(this)}\r\n          />\r\n          <CustomButton\r\n            style={BUTTON_STYLE.BRICK}\r\n            type={BUTTON_TYPE.SECONDARY}\r\n            size={BUTTON_SIZE.LARGE}\r\n            color={COLOR.PRIMARY}\r\n            align=\"right\"\r\n            label=\"Cancel\"\r\n            isButtonGroup={true}\r\n            onClick={this.onCancel.bind(this)}\r\n          />\r\n        </div>\r\n        <div style={{ height: \"100px\" }}></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n}\r\n"]},"metadata":{},"sourceType":"module"}